(this["webpackJsonpsocial-media"]=this["webpackJsonpsocial-media"]||[]).push([[0],{38:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){},96:function(e,t,a){},97:function(e,t,a){},98:function(e,t,a){"use strict";a.r(t);var n=a(3),c=a(7),o=a(8),i=a(42),s={isLoggedIn:!!localStorage.getItem("token"),userInfo:{token:localStorage.getItem("token"),userId:localStorage.getItem("userId"),email:localStorage.getItem("email"),photoUrl:localStorage.getItem("photoUrl"),displayName:localStorage.getItem("displayName")},isErrorEmailExists:!1,isPasswordValid:!1,isErrorEmailNotFound:!1,tooManyAttempts:!1},r=Object(i.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(o.a)(Object(o.a)({},e),{},{userInfo:Object(o.a)(Object(o.a)({},e.userInfo),{},{token:t.payload.token,userId:t.payload.userId,email:t.payload.email}),isLoggedIn:!0});case"SET_USER_INFO":return Object(o.a)(Object(o.a)({},e),{},{userInfo:Object(o.a)(Object(o.a)({},e.userInfo),{},{photoUrl:t.payload.photoUrl,displayName:t.payload.displayName})});case"LOGOUT":return Object(o.a)(Object(o.a)({},e),{},{userInfo:{token:"",userId:"",email:"",photoUrl:"",displayName:""},isLoggedIn:!1});case"CHANGE_NAME":return Object(o.a)(Object(o.a)({},e),{},{displayName:t.displayName});case"EMAIL_EXISTS":return Object(o.a)(Object(o.a)({},e),{},{isErrorEmailExists:t.boolean});case"EMAIL_NOT_FOUND":return Object(o.a)(Object(o.a)({},e),{},{isErrorEmailNotFound:t.boolean});case"INVALID_PASSWORD":return Object(o.a)(Object(o.a)({},e),{},{isPasswordValid:t.boolean});case"TOO_MANY_ATTEMPTS_TRY_LATER":return Object(o.a)(Object(o.a)({},e),{},{tooManyAttempts:t.boolean});default:return e}})),l=a(28),u=a.n(l),j=(a(50),a(51),a(5)),d=a(12),f=a(16),b=(a(52),a.p+"static/media/user.c9207524.png"),m=function(e){var t=(new Date).getTime();return new Date(e).getTime()-t},p=function(){Object(c.c)((function(e){return e.userInfo}));var e=Object(d.g)(),t=Object(c.b)(),a=function(){var e=localStorage.getItem("expirationTime"),t=m(e);return t<=6e4?(localStorage.removeItem("token"),localStorage.removeItem("expirationTime"),null):t}(),o=Object(n.useState)(localStorage.getItem("expirationTime")),i=Object(j.a)(o,2),s=i[0],r=i[1],l=function(a,n,c,o){"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyBSIZSdghkjvJ_8hJt-FAicfpHNpUAVsPI"===o?(localStorage.setItem("displayName",c.substring(0,c.indexOf("@"))),localStorage.setItem("photoUrl",b),t({type:"SET_USER_INFO",payload:{displayName:c.substring(0,c.indexOf("@")),photoUrl:b}}),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users/".concat(n,".json?auth=").concat(a),{method:"PUT",body:JSON.stringify({email:c,displayName:c.substring(0,c.indexOf("@")),photoUrl:""}),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();console.log(e)})).catch((function(e){console.log(e)}))):fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users/".concat(n,".json?auth=").concat(a)).then((function(e){if(e.ok)return e.json();console.log(e),e.json().then((function(e){}))})).then((function(a){var n="";return n=""===a.photoUrl?b:a.photoUrl,localStorage.setItem("displayName",a.displayName),localStorage.setItem("photoUrl",n),t({type:"SET_USER_INFO",payload:{displayName:a.displayName,photoUrl:n}}),e.replace("/feed")})).catch((function(e){console.log(e.message)})),e.replace("/social-media/feed")},u=Object(n.useCallback)((function(){localStorage.clear(),t({type:"LOGOUT"}),s&&clearTimeout(s)}),[s,t]);return Object(n.useEffect)((function(){a&&r(setTimeout(u,a))}),[r]),{login:function(e,a,n){fetch(e,{method:"POST",body:JSON.stringify({email:a,password:n,returnSecureToken:!0}),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return t({type:"IS_ERROR",boolean:!1}),e.json();e.json().then((function(e){"EMAIL_EXISTS"===e.error.message&&t({type:"EMAIL_EXISTS",boolean:!0}),"EMAIL_NOT_FOUND"===e.error.message&&t({type:"EMAIL_NOT_FOUND",boolean:!0}),"INVALID_PASSWORD"===e.error.message&&t({type:"INVALID_PASSWORD",boolean:!0}),"TOO_MANY_ATTEMPTS_TRY_LATER"===e.error.message&&t({type:"TOO_MANY_ATTEMPTS_TRY_LATER",boolean:!0}),console.log(e.error)}))})).then((function(a){t({type:"LOGIN",payload:{token:a.idToken,userId:a.localId,email:a.email}}),localStorage.setItem("token",a.idToken),localStorage.setItem("userId",a.localId),localStorage.setItem("email",a.email);var n=new Date((new Date).getTime()+1e3*+a.expiresIn);localStorage.setItem("expirationTime",n.toISOString());var c=m(n);r(setTimeout(u,c)),l(a.idToken,a.localId,a.email,e)})).catch((function(e){console.log(e.message)}))},logout:u}},h=a.p+"static/media/hamburger.ab2c8b29.svg",O=a(2),g=function(){var e=Object(d.g)(),t=Object(c.c)((function(e){return e.isLoggedIn})),a=Object(c.c)((function(e){return e.userInfo.photoUrl})),o=Object(c.c)((function(e){return e.userInfo.displayName})),i=Object(n.useState)(!0),s=Object(j.a)(i,2),r=s[0],l=s[1],u=Object(n.useState)(!1),b=Object(j.a)(u,2),m=b[0],g=b[1],v=p().logout;return Object(n.useEffect)((function(){l(void 0===o||void 0===a)}),[o,a]),Object(O.jsx)("header",{className:t&&m?"expand-header":"",children:Object(O.jsxs)("nav",{className:"header-nav  ".concat(t?"header-nav-mobile":""),children:[t&&Object(O.jsx)("button",{className:"header-nav-menu ".concat(m?"fade-menu":""),onClick:function(){g((function(e){return!e}))},children:Object(O.jsx)("img",{src:h})}),Object(O.jsxs)("ul",{className:"header-nav-list ".concat(!m&&t?"hide-menu":""," ").concat(t?"header-nav-list-logged":""),children:[t&&Object(O.jsx)("li",{className:"header-nav-feed ",children:Object(O.jsx)(f.b,{to:"/social-media/feed",children:"Home"})}),t&&(r?Object(O.jsx)("p",{children:"Loading..."}):Object(O.jsx)("li",{children:Object(O.jsxs)(f.b,{to:"/social-media/profile",className:"header-nav-profile",children:[Object(O.jsx)("div",{className:"header-div-avatar",children:Object(O.jsx)("img",{src:a})}),o]})})),t&&Object(O.jsx)("li",{className:"header-nav-button-container",children:Object(O.jsx)("button",{onClick:function(){v(),e.replace("/")},className:"header-nav-button",children:"Logout"})}),!t&&Object(O.jsx)("li",{className:"header-nav-login",children:Object(O.jsx)(f.b,{to:"/social-media/login",children:"Login"})}),!t&&Object(O.jsx)("li",{className:"header-nav-signup",children:Object(O.jsx)(f.b,{to:"/social-media/signup",children:"Sign up"})})]})]})})},v=(a(38),function(){var e=p().login,t=Object(c.b)(),a=Object(n.useRef)(),o=Object(n.useRef)(),i=Object(c.c)((function(e){return e.isErrorEmailNotFound})),s=Object(c.c)((function(e){return e.isPasswordValid})),r=Object(c.c)((function(e){return e.tooManyAttempts}));return Object(O.jsxs)("form",{onSubmit:function(n){n.preventDefault();var c=a.current.value,i=o.current.value;t({type:"EMAIL_NOT_FOUND",boolean:!1}),t({type:"INVALID_PASSWORD",boolean:!1}),t({type:"TOO_MANY_ATTEMPTS_TRY_LATER",boolean:!1}),e("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyBSIZSdghkjvJ_8hJt-FAicfpHNpUAVsPI",c,i)},className:"authentification-form",children:[Object(O.jsx)("div",{className:"authentification-form__name",children:Object(O.jsx)("h1",{children:"Login"})}),Object(O.jsxs)("div",{className:"authentification-form__inputs",children:[Object(O.jsx)("input",{className:i?"invalid":"",type:"email",ref:a,placeholder:"Email",required:!0}),i&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Invalid email"}),Object(O.jsx)("input",{className:s?"invalid":"",type:"password",ref:o,placeholder:"Password",required:!0}),s&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Invalid password"}),r&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Too many failed attempts, try again later."}),Object(O.jsxs)("div",{className:"authentification-form__actions",children:[Object(O.jsx)("input",{type:"submit",className:"authentification-form__submit",value:"Sign in"}),Object(O.jsx)(f.b,{to:"/social-media/signup",className:"authentification-form__link",children:"Create account"})]})]})]})}),x=a(21),N=a.n(x),_=function(){var e=Object(c.b)(),t=p().login,a=Object(c.c)((function(e){return e.isErrorEmailExists})),o=Object(n.useState)(""),i=Object(j.a)(o,2),s=i[0],r=i[1],l=Object(n.useState)(""),u=Object(j.a)(l,2),d=u[0],b=u[1],m=Object(n.useState)(""),h=Object(j.a)(m,2),g=h[0],v=h[1],x=Object(n.useState)(),_=Object(j.a)(x,2),S=_[0],I=_[1],y=Object(n.useState)(),E=Object(j.a)(y,2),T=E[0],U=E[1],k=Object(n.useState)(),D=Object(j.a)(k,2),L=D[0],w=D[1],A=Object(n.useState)(!1),P=Object(j.a)(A,2),R=P[0],C=P[1],F=Object(n.useState)(!1),M=Object(j.a)(F,2),J=M[0],Z=M[1],H=function(){var e=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return w(!e.test(s)),I(d!==g),U(d.length<6),S||T||L};Object(n.useEffect)((function(){C(H())}),[H]);return Object(O.jsxs)("form",{onSubmit:function(e){e.preventDefault(),Z(!1),(new N.a).isProfane(s)?Z(!0):R||t("https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyBSIZSdghkjvJ_8hJt-FAicfpHNpUAVsPI",s,d)},className:"authentification-form",children:[Object(O.jsx)("div",{className:"authentification-form__name",children:Object(O.jsx)("h1",{children:"Sign up"})}),Object(O.jsxs)("div",{className:"authentification-form__inputs",children:[Object(O.jsx)("input",{className:a||L?"invalid":"",type:"email",value:s,onChange:function(t){e({type:"EMAIL_EXISTS",boolean:!1}),r(t.target.value)},required:!0}),a&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Email exists already"}),L&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Email is not valid"}),J&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Innappropriate language"}),Object(O.jsx)("input",{className:T?"invalid":"",type:"password",value:d,onChange:function(e){b(e.target.value)},required:!0}),T&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Password is shorter than 6 characters"}),Object(O.jsx)("input",{className:S?"invalid":"",type:"password",value:g,onChange:function(e){v(e.target.value)},required:!0}),S&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Passwords do not match"}),Object(O.jsxs)("div",{className:"authentification-form__actions",children:[Object(O.jsx)("input",{type:"submit",value:"Sign up",className:"authentification-form__submit",disabled:R}),Object(O.jsx)(f.b,{to:"/social-media/login",className:"authentification-form__link",children:"Have account already?"})]})]})]})},S=function(){var e=Object(d.h)();return Object(O.jsx)("div",{children:"/social-media/login"===e.pathname?Object(O.jsx)(v,{}):Object(O.jsx)(_,{})})},I=a(37);I.a.initializeApp({apiKey:" AIzaSyBSIZSdghkjvJ_8hJt-FAicfpHNpUAVsPI ",authDomain:"https://react-http-560ff-default-rtdb.firebaseapp.com",projectId:"react-http-560ff",storageBucket:"react-http-560ff.appspot.com",messagingSenderId:"",appId:""});var y=I.a,E=(a(72),a(30)),T=(a(73),function(e){var t=e.data,a=e.dispatch,c=Object(n.useRef)(),o=Object(n.useState)(""),i=Object(j.a)(o,2),s=i[0],r=i[1];Object(n.useEffect)((function(){e.sent&&r("")}),[e.sent]);return Object(O.jsx)("textarea",{rows:"4",cols:"50",className:t.inDropZone?"drag-drop-zone inside-drag-area":"drag-drop-zone",onDrop:function(e){e.preventDefault();var t=Object(E.a)(e.dataTransfer.files);if(t[0].type.match(/image.*/)&&t&&t.length>0){console.log(URL.createObjectURL(t[0]));var n=t[0];a({type:"ADD_FILE",fileUpload:n}),a({type:"SET_DROP_DEPTH",dropDepth:0}),a({type:"SET_IN_DROP_ZONE",inDropZone:!1})}},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",a({type:"SET_IN_DROP_ZONE",inDropZone:!0})},onDragEnter:function(e){e.preventDefault(),a({type:"SET_DROP_DEPTH",dropDepth:t.dropDepth+1})},onDragLeave:function(e){e.preventDefault(),a({type:"SET_DROP_DEPTH",dropDepth:t.dropDepth-1}),a({type:"SET_IN_DROP_ZONE",inDropZone:!1})},ref:c,onChange:function(e){r(e.target.value);var t=c.current.value;a({type:"ADD_TEXT",text:t})},value:s,placeholder:"Add text,image or gif ..."})}),U=function(e,t){switch(t.type){case"ADD_TEXT":return Object(o.a)(Object(o.a)({},e),{},{text:t.text});case"SET_DROP_DEPTH":return Object(o.a)(Object(o.a)({},e),{},{dropDepth:t.dropDepth});case"SET_IN_DROP_ZONE":return Object(o.a)(Object(o.a)({},e),{},{inDropZone:t.inDropZone});case"ADD_FILE":return Object(o.a)(Object(o.a)({},e),{},{file:t.fileUpload});case"DELETE_FILE":return Object(o.a)(Object(o.a)({},e),{},{file:{}});default:return e}},k=function(e){var t=null,a=Object(c.c)((function(e){return e.userInfo.token})),o=Object(c.c)((function(e){return e.userInfo.userId})),i=Object(c.c)((function(e){return e.userInfo.photoUrl})),s=Object(c.c)((function(e){return e.userInfo.displayName})),r=Object(n.useState)(!1),l=Object(j.a)(r,2),u=l[0],d=l[1],f=Object(n.useState)(!0),b=Object(j.a)(f,2),m=b[0],p=b[1],h=Object(n.useState)(!1),g=Object(j.a)(h,2),v=g[0],x=g[1],_=Object(n.useState)(0),S=Object(j.a)(_,2),I=S[0],E=S[1],k=Object(n.useState)(!1),D=Object(j.a)(k,2),L=D[0],w=D[1],A=Object(n.useReducer)(U,{text:"",dropDepth:0,inDropZone:!1,file:{}}),P=Object(j.a)(A,2),R=P[0],C=P[1],F=R.file,M=R.text;Object(n.useEffect)((function(){p(void 0===i||void 0===s)}),[i,s]);var J=function(n,c){return fetch("https://react-http-560ff-default-rtdb.firebaseio.com/posts/".concat(o,".json?auth=").concat(a),{method:"POST",body:JSON.stringify({text:n,imageURL:c}),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return x(!0),w(!0),t=setTimeout((function(){w(!1)}),3e3),C({type:"DELETE_FILE"}),e.json();e.json().then((function(e){console.log(e)}))})).then((function(t){e.sendPost()})),function(){return clearTimeout(t)}};return Object(O.jsxs)("div",{className:"post-form__container",children:[m?Object(O.jsx)("p",{children:"Loading..."}):Object(O.jsxs)("div",{className:"post-form__heading",children:[Object(O.jsx)("div",{className:"post-form__avatar",children:Object(O.jsx)("img",{src:i,alt:"profile pic"})}),Object(O.jsx)("div",{className:"post-form__name",children:s})]}),Object(O.jsxs)("form",{className:"post-form__form",onSubmit:function(e){d(!1),E(0),e.preventDefault();var t=new N.a;if(x(!1),!(M.length<1))if(M.length>300)E(M.length);else if(t.isProfane(M))d(!0);else if(F.name){var a=y.storage().ref().child("postsImage/".concat(o,"/").concat(F.name)).put(F);console.log(F),a.on(y.storage.TaskEvent.STATE_CHANGED,(function(e){}),(function(e){throw e}),(function(){a.snapshot.ref.getDownloadURL().then((function(e){J(M,e)}))}))}else J(M,"")},children:[L&&Object(O.jsx)("div",{className:"post-form__message",children:"Posted!"}),Object(O.jsx)(T,{data:R,dispatch:C,sent:v}),F.name&&Object(O.jsxs)("div",{className:"post-form__dropped-file",children:[Object(O.jsx)("button",{className:"post-form__dropped-file__undo",onClick:function(){C({type:"DELETE_FILE"})},children:"x"}),Object(O.jsx)("img",{src:URL.createObjectURL(F),alt:F.name})]}),I>300&&Object(O.jsxs)("p",{children:["Only 300 characters allowed, you have ",I]}),u&&Object(O.jsx)("p",{children:"Prohibited language!"}),Object(O.jsx)("input",{type:"submit",className:"post-form__submit",value:"Post"})]})]})},D=a(36),L=a.n(D),w=a(41),A=(a(75),a.p+"static/media/heart.7da58c3c.svg"),P=(a(76),a(77),a.p+"static/media/text-bubble.dd06dd25.svg"),R=a(23),C=a.n(R),F=function(e){var t=Object(n.useState)(!1),a=Object(j.a)(t,2),o=a[0],i=a[1],s=Object(c.c)((function(e){return e.userInfo.userId})),r=Object(c.c)((function(e){return e.userInfo.token})),l=Object(c.c)((function(e){return e.userInfo.displayName})),u=Object(c.c)((function(e){return e.userInfo.photoUrl})),d=Object(n.useState)([]),f=Object(j.a)(d,2),b=f[0],m=f[1],p=Object(n.useState)(""),h=Object(j.a)(p,2),g=h[0],v=h[1],x=Object(n.useState)(0),_=Object(j.a)(x,2),S=_[0],I=_[1],y=Object(n.useState)(!1),T=Object(j.a)(y,2),U=T[0],k=T[1],D=Object(n.useState)(!0),L=Object(j.a)(D,2),w=L[0],A=L[1],R=Object(n.useState)(!1),F=Object(j.a)(R,2),M=F[0],J=F[1];Object(n.useEffect)((function(){var t={},a=[];o&&!M&&(A(!0),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/comments/".concat(e.id,".json")).then((function(e){if(e.ok)return e.json();e.json().then((function(e){console.log(e)}))})).then((function(e){for(var n in e){var c=[];for(var o in e[n])c.push(e[n][o].comment);a.push({userId:n,comments:c,displayName:"",photoUrl:""})}return fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users.json").then((function(e){if(e.ok)return e.json();e.json().then((function(e){console.log(e)}))})).then((function(e){for(var n in e)t[n]={displayName:e[n].displayName,photoUrl:e[n].photoUrl};var c="";for(var o in a)c=a[o].userId,a[o].displayName=t[c].displayName,a[o].photoUrl=t[c].photoUrl;m(a),A(!1),J(!0),console.log(a)}))})))}),[o]);return Object(O.jsxs)("div",{className:"comments-section",children:[Object(O.jsx)("button",{className:"comments-section__button",onClick:function(){i((function(e){return!e}))},children:Object(O.jsx)("img",{src:P})}),o&&(w?Object(O.jsx)(C.a,{type:"ThreeDots",color:"#585d99",height:50,width:50}):Object(O.jsxs)("div",{className:"comments-section__container",children:[Object(O.jsx)("ul",{className:"comments-section__list",children:b.map((function(e){return e.comments.map((function(t){return Object(O.jsx)("li",{children:Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"comments-section__user-info",children:[Object(O.jsx)("img",{className:"comments-section__avatar",src:e.photoUrl}),Object(O.jsx)("div",{children:e.displayName})]}),Object(O.jsx)("div",{className:"comments-section__comment",children:t})]})})}))}))}),Object(O.jsx)("textarea",{onKeyPress:function(t){if("Enter"===t.key){var a=t.target.value,n=new N.a;if(k(!1),n.isProfane(a))return void k(!0);if(a.length<1)return;if(a.length>300)return void I(a.length);fetch("https://react-http-560ff-default-rtdb.firebaseio.com/comments/".concat(e.postId,"/").concat(s,".json?auth=").concat(r),{method:"POST",body:JSON.stringify({comment:a}),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return console.log(e),e.json();e.json().then((function(e){console.log(e)}))})).then((function(e){m((function(e){return[].concat(Object(E.a)(e),[{displayName:l,photoUrl:u,comments:[a]}])})),v("")}))}},onChange:function(e){v(e.target.value),I(0)},placeholder:"Write a comment...",value:g,className:"comments-section__container__write",rows:"4",columns:"50"}),S>300&&Object(O.jsxs)("p",{className:"comments-section__warning",children:["Comment should be less than 300 chars,you have ",S]}),U&&Object(O.jsx)("p",{className:"comments-section__warning",children:"Innapropriate language"})]}))]})},M=function(e){var t=localStorage.getItem("token"),a=localStorage.getItem("userId"),c=Object(n.useState)(!1),o=Object(j.a)(c,2),i=o[0],s=o[1],r=Object(n.useState)(Object.keys(e.likes).length),l=Object(j.a)(r,2),u=l[0],d=l[1],b=Object(n.useState)(""),m=Object(j.a)(b,2),p=m[0],h=m[1],g=Object(n.useState)(!0),v=Object(j.a)(g,2),x=v[0],N=v[1];return Object(n.useEffect)((function(){for(var t in e.likes)for(var n in e.likes[t])if(e.likes[t][n]===a){h(n),s(!0);break}}),[]),x&&Object(O.jsxs)("div",{className:"post-card",children:[Object(O.jsxs)("div",{className:"post-card__heading",children:[Object(O.jsxs)(f.b,{to:"/social-media/user/".concat(e.userId),children:[Object(O.jsx)("img",{className:"post-card__avatar",src:e.photoUrl}),e.displayName]}),Object(O.jsx)("div",{children:e.ownProfile&&Object(O.jsx)("button",{className:"post-card__heading__delete",onClick:function(){window.confirm("Your post will be deleted")&&(N(!1),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/posts/".concat(e.userId,"/").concat(e.id,".json?auth=").concat(t),{method:"DELETE"}).then((function(e){if(e.ok)return e.json();e.json().then((function(e){console.log(e)}))})))},children:"x"})})]}),Object(O.jsxs)("div",{className:"post-card__content",children:[Object(O.jsx)("div",{className:"post-card__text",children:e.text}),e.imageURL&&Object(O.jsx)("div",{className:"post-card__image",children:Object(O.jsx)("img",{src:e.imageURL})})]}),Object(O.jsxs)("div",{className:"post-card__actions",children:[Object(O.jsxs)("div",{className:"post-card__likes",children:[Object(O.jsx)("button",{onClick:function(){i?(s(!1),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/liked/".concat(e.id,"/").concat(p,"/.json"),{method:"DELETE"}).then((function(e){return e.json()})).then((function(e){h(""),d((function(e){return e-1}))}))):(s(!0),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/liked/".concat(e.id,".json"),{method:"POST",body:JSON.stringify(localStorage.getItem("userId")),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return console.log(e),d((function(e){return e+1})),e.json();e.json().then((function(e){console.log(e)}))})))},children:Object(O.jsx)("img",{src:A,className:i?"liked":""})}),Object(O.jsx)("div",{children:e.likes&&u})]}),Object(O.jsx)(F,{id:e.id})]})]})},J=function(e){var t=Object(n.useState)([]),a=Object(j.a)(t,2),i=a[0],s=a[1],r=Object(n.useState)(!0),l=Object(j.a)(r,2),u=l[0],d=l[1],f=(Object(c.c)((function(e){return e.userInfo.token})),Object(n.useCallback)(Object(w.a)(L.a.mark((function e(){var t,a,n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d(!0),t=[],a=[],n=[],fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users.json?").then((function(e){return e.json()})).then((function(e){for(var c in e)t.push({id:c,displayName:e[c].displayName,photoUrl:e[c].photoUrl});return fetch("https://react-http-560ff-default-rtdb.firebaseio.com/liked.json").then((function(e){return e.json()})).then((function(e){return a=e,fetch("https://react-http-560ff-default-rtdb.firebaseio.com/posts.json").then((function(e){return e.json()})).then((function(e){var c=[];for(var i in e){var r="";for(var l in t)t[l].id===i&&(r=t[l]);for(var u in e[i]){for(var j in n=[],a)j===u&&n.push(a[j]);c.push(Object(o.a)(Object(o.a)({},e[i][u]),{},{id:u,userId:i,displayName:r.displayName,photoUrl:r.photoUrl,likes:n}))}}s(c),d(!1)}))}))}));case 5:case"end":return e.stop()}}),e)}))),[]));Object(n.useEffect)((function(){f()}),[f,e.toggleNewPost]);var b=i.map((function(e){return Object(O.jsx)(M,{id:e.id,text:e.text,imageURL:e.imageURL,userId:e.userId,displayName:e.displayName,photoUrl:e.photoUrl,likes:e.likes},e.id)})).reverse();return Object(O.jsx)("div",{className:"post-list-container",children:u?Object(O.jsx)(C.a,{type:"TailSpin",color:"#585d99",height:100,width:100}):Object(O.jsx)("div",{children:b})})},Z=function(){var e=Object(n.useState)(!1),t=Object(j.a)(e,2),a=t[0],c=t[1];return Object(O.jsxs)("div",{children:[Object(O.jsx)(k,{sendPost:function(){c((function(e){return!e}))}}),Object(O.jsx)(J,{toggleNewPost:a})]})},H=(a(96),a.p+"static/media/edit.a609e087.svg"),V=a.p+"static/media/tick.acf55764.svg",z=a.p+"static/media/close.195726a4.svg",Y=function(e){var t=Object(d.h)(),a=Object(c.b)(),o=Object(n.useRef)(),i=Object(n.useState)(e.photoUrl),s=Object(j.a)(i,2),r=s[0],l=s[1],u=Object(n.useState)(e.displayName),f=Object(j.a)(u,2),b=f[0],m=f[1],p=Object(n.useState)(e.email),h=Object(j.a)(p,2),g=h[0],v=h[1],x=Object(n.useState)(b),_=Object(j.a)(x,2),S=_[0],I=_[1],E=Object(n.useState)(!1),T=Object(j.a)(E,2),U=T[0],k=T[1],D=Object(n.useState)(!1),L=Object(j.a)(D,2),w=L[0],A=L[1],P=Object(n.useState)(!1),R=Object(j.a)(P,2),C=R[0],F=R[1],M=Object(n.useState)(!1),J=Object(j.a)(M,2),Z=J[0],Y=J[1],G=Object(n.useState)(!1),B=Object(j.a)(G,2),W=B[0],X=B[1],q=Object(n.useState)(!0),K=Object(j.a)(q,2),$=K[0],Q=K[1];Object(n.useEffect)((function(){m(e.displayName),v(e.email),l(e.photoUrl)}),[e.displayName,e.photoUrl,e.email]);var ee=localStorage.getItem("token"),te=localStorage.getItem("userId"),ae=function(){Q(!0),Y((function(e){return!e}))},ne=function(){F(!1),l(localStorage.getItem("photoUrl")),A((function(e){return!e}))},ce=function(e){fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users/".concat(te,".json?auth=").concat(ee),{method:"PATCH",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();e.json().then((function(e){}))})).then((function(e){a({type:"SET_USER_INFO",payload:{displayName:localStorage.getItem("displayName"),photoUrl:localStorage.getItem("photoUrl")}})})).catch((function(e){console.log(e.message)}))};return Object(O.jsxs)("div",{className:"profile",children:[Object(O.jsx)("div",{className:"profile-image-side",children:Object(O.jsxs)("div",{className:"profile-image",children:[U?Object(O.jsx)("p",{children:"Loading..."}):Object(O.jsx)("img",{src:r,alt:"avatar"}),"/social-media/profile"===t.pathname&&Object(O.jsxs)("div",{className:"profile-image-photo-edit",children:[w?Object(O.jsx)("input",{type:"file",name:"avatar",accept:"image/png, image/jpeg, image/jpg",ref:o,onChange:function(e){k(!0);var t=e.target.files[0];F(!0);var a=y.storage().ref().child("avatars/".concat(te,"/").concat(t.name)).put(t);a.on(y.storage.TaskEvent.STATE_CHANGED,(function(e){}),(function(e){throw e}),(function(){a.snapshot.ref.getDownloadURL().then((function(e){l(e),k(!1)}))}))}}):Object(O.jsx)("button",{className:"profile-chnage-photo-button",onClick:ne,children:"Change photo"}),w&&Object(O.jsxs)("div",{className:"profile-edit-photo-buttons-div",children:[C&&Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:function(e){localStorage.removeItem("photoURL"),localStorage.setItem("photoUrl",r),ce({photoUrl:r}),A(!1)},children:Object(O.jsx)("img",{src:V})}),Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:ne,children:Object(O.jsx)("img",{src:z})})]})]})]})}),Object(O.jsxs)("div",{className:"profile-info",children:[Object(O.jsxs)("div",{className:"profile-edit-name",children:[Z&&"/social-media/profile"===t.pathname?Object(O.jsx)("input",{type:"text",value:S,onChange:function(e){I(e.target.value)}}):Object(O.jsx)("div",{className:"profile-name",children:b}),"/social-media/profile"===t.pathname&&Object(O.jsx)("div",{children:Z?Object(O.jsxs)("div",{className:"profile-edit-name-buttons-div",children:[Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:function(){var e;(X(!1),(new N.a).isProfane(S))?X(!0):(e=S).length<21&&e.length>0?(Q(!0),localStorage.removeItem("displayName"),localStorage.setItem("displayName",S),ce({displayName:S}),ae(),m(S)):Q(!1)},children:Object(O.jsx)("img",{src:V})}),Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:ae,children:Object(O.jsx)("img",{src:z})})]}):Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:ae,children:Object(O.jsx)("img",{src:H})})})]}),Z&&!$&&Object(O.jsx)("p",{div:!0,className:"profile-name-error",children:"Name has to be shorter than 20 characters and atleast 1 character."}),W&&Object(O.jsx)("p",{div:!0,className:"profile-name-error",children:"Innapproriate name"}),Object(O.jsx)("div",{className:"profile-email",children:g})]})]})},G=(a(97),function(e){var t=Object(d.h)(),a=localStorage.getItem("userId"),o=Object(c.c)((function(e){return e.userInfo.displayName})),i=Object(n.useState)([]),s=Object(j.a)(i,2),r=s[0],l=s[1],u=Object(n.useState)(!0),f=Object(j.a)(u,2),b=f[0],m=f[1],p=[],h=[];Object(n.useEffect)((function(){if(m(!0),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/liked.json").then((function(e){return e.json()})).then((function(e){h=e})),"/social-media/profile"===t.pathname)return g(a);var n=e.currentUserId;return g(n)}),[fetch,e.displayName,o,a]);var g=function(t){var a=[];fetch("https://react-http-560ff-default-rtdb.firebaseio.com/posts/".concat(t,".json")).then((function(e){return e.json()})).then((function(n){for(var c in n){for(var o in p=[],h)o===c&&p.push(h[o]);a.push({id:c,text:n[c].text,imageURL:n[c].imageURL,userId:t,displayName:e.displayName,photoUrl:e.photoUrl,likes:p})}l(a),m(!1)}))},v=r.map((function(t){return Object(O.jsx)(M,{id:t.id,text:t.text,imageURL:t.imageURL,userId:t.userId,displayName:t.displayName,photoUrl:t.photoUrl,likes:t.likes,ownProfile:e.ownProfile},t.id)})).reverse();return Object(O.jsx)("div",{className:"post-list-container",children:b?Object(O.jsx)(C.a,{type:"TailSpin",color:"#585d99",height:100,width:100}):v})}),B=function(){Object(d.g)();var e=Object(n.useState)(Object(c.c)((function(e){return e.userInfo.photoUrl}))),t=Object(j.a)(e,2),a=t[0],o=t[1],i=Object(c.c)((function(e){return e.userInfo.displayName})),s=Object(n.useState)(Object(c.c)((function(e){return e.userInfo.displayName}))),r=Object(j.a)(s,2),l=r[0],u=r[1],f=Object(n.useState)(Object(c.c)((function(e){return e.userInfo.email}))),m=Object(j.a)(f,2),p=m[0],h=m[1],g=Object(n.useState)(!0),v=Object(j.a)(g,2),x=v[0],N=v[1],_=Object(d.h)(),S=localStorage.getItem("token"),I=_.pathname.slice(19,_.pathname.length);return Object(n.useEffect)((function(){"/social-media/profile"!==_.pathname?(N(!0),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users/".concat(I,".json?auth=").concat(S)).then((function(e){if(e.ok)return e.json();console.log(e),e.json().then((function(e){}))})).then((function(e){u(e.displayName),h(e.email),""===e.photoUrl?o(b):o(e.photoUrl),N(!1)})).catch((function(e){console.log(e.message)}))):N(!1)}),[_,I,S]),Object(O.jsxs)("div",{children:[x?Object(O.jsx)("p",{children:"Loading"}):"/social-media/profile"===_.pathname?Object(O.jsx)(Y,{displayName:i,email:localStorage.getItem("email"),photoUrl:localStorage.getItem("photoUrl")}):Object(O.jsx)(Y,{displayName:l,email:p,photoUrl:a}),x?Object(O.jsx)("p",{children:"Loading"}):Object(O.jsx)("div",{children:"/social-media/profile"===_.pathname?Object(O.jsx)(G,{displayName:i,photoUrl:localStorage.getItem("photoUrl"),ownProfile:!0}):Object(O.jsx)(G,{currentUserId:I,displayName:l,photoUrl:a,ownProfile:!1})})]})};var W=function(){var e=Object(c.c)((function(e){return e.isLoggedIn})),t=localStorage.getItem("userId");return Object(O.jsxs)("main",{children:[Object(O.jsx)(g,{}),Object(O.jsxs)(d.d,{children:[Object(O.jsxs)(d.b,{path:"/social-media",exact:!0,children:[!e&&Object(O.jsx)(d.a,{to:"/social-media/login",children:Object(O.jsx)(S,{})}),e&&Object(O.jsx)(d.a,{to:"/social-media/feed",children:Object(O.jsx)(Z,{})})]}),!e&&Object(O.jsx)(d.b,{path:"/social-media/login",children:Object(O.jsx)(S,{})}),!e&&Object(O.jsx)(d.b,{path:"/social-media/signup",children:Object(O.jsx)(S,{})}),e&&Object(O.jsx)(d.b,{path:"/social-media/profile",children:Object(O.jsx)(B,{})}),e&&Object(O.jsx)(d.b,{path:"/social-media/feed",children:Object(O.jsx)(Z,{})}),e&&Object(O.jsx)(d.b,{path:"/social-media/user/".concat(t),children:Object(O.jsx)(d.a,{to:"/social-media/profile"})}),e&&Object(O.jsx)(d.b,{path:"/social-media/user",children:Object(O.jsx)(B,{})}),Object(O.jsx)(d.b,{path:"*",children:Object(O.jsx)(d.a,{to:"/social-media"})})]})]})};u.a.render(Object(O.jsx)(c.a,{store:r,children:Object(O.jsx)(f.a,{basename:"/repo-name",children:Object(O.jsx)(W,{})})}),document.getElementById("root"))}},[[98,1,2]]]);
//# sourceMappingURL=main.791fd4f8.chunk.js.map